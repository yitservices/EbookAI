@{
    ViewData["Title"] = "Help & Feedback Management";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<style>
    :root {
        --white: #FFFFFF;
        --light-gray: #F5F5F5;
        --cream-bg: #FAF8F3;
        --cream-accent: #E8DCC6;
        --text-primary: #2C2C2C;
        --text-secondary: #6B6B6B;
        --border-light: #E5E5E5;
        --primary: #8B7355;
        --success: #10b981;
        --danger: #ef4444;
        --warning: #f59e0b;
    }

    .help-container {
        padding: 0;
    }

    .page-header {
        background: var(--white);
        border-radius: 16px;
        padding: 24px;
        margin-bottom: 24px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        border: 1px solid var(--border-light);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 16px;
    }

    .filters-section {
        background: var(--white);
        border-radius: 16px;
        padding: 20px;
        margin-bottom: 24px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        border: 1px solid var(--border-light);
    }

    .filters-row {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 16px;
    }

    .form-control {
        width: 100%;
        padding: 10px 14px;
        border: 1px solid var(--border-light);
        border-radius: 10px;
        font-size: 14px;
    }

    .ticket-card {
        background: var(--white);
        border-radius: 16px;
        padding: 20px;
        margin-bottom: 16px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        border: 1px solid var(--border-light);
        border-left: 4px solid var(--primary);
        transition: all 0.3s ease;
    }

    .ticket-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .ticket-header {
        display: flex;
        justify-content: space-between;
        align-items: start;
        margin-bottom: 12px;
    }

    .ticket-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--text-primary);
    }

    .ticket-type {
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 500;
        text-transform: uppercase;
    }

    .type-bug {
        background: rgba(239, 68, 68, 0.1);
        color: var(--danger);
    }

    .type-feature {
        background: rgba(16, 185, 129, 0.1);
        color: var(--success);
    }

    .type-complaint {
        background: rgba(245, 158, 11, 0.1);
        color: var(--warning);
    }

    .type-general {
        background: rgba(139, 115, 85, 0.1);
        color: var(--primary);
    }

    .ticket-meta {
        display: flex;
        gap: 16px;
        font-size: 12px;
        color: var(--text-secondary);
        margin-top: 12px;
    }

    .btn {
        padding: 8px 16px;
        border: none;
        border-radius: 8px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 14px;
        display: inline-flex;
        align-items: center;
        gap: 6px;
    }

    .btn-primary {
        background: var(--primary);
        color: white;
    }

    .btn-primary:hover {
        background: var(--primary-dark);
    }

    .btn-secondary {
        background: var(--light-gray);
        color: var(--text-primary);
        border: 1px solid var(--border-light);
    }
</style>

<div class="help-container">
    <div class="page-header">
        <div>
            <h1 style="font-size: 24px; font-weight: 700; color: var(--text-primary); margin-bottom: 4px;">Help & Feedback Management</h1>
            <p style="color: var(--text-secondary);">View, assign, and respond to help requests and feedback</p>
        </div>
    </div>

    <div class="filters-section">
        <div class="filters-row">
            <div>
                <label style="display: block; font-size: 12px; font-weight: 500; color: var(--text-secondary); margin-bottom: 6px;">Filter by Type</label>
                <select class="form-control" id="typeFilter">
                    <option value="">All Types</option>
                    <option value="bug">Bug Report</option>
                    <option value="feature">Feature Request</option>
                    <option value="complaint">Complaint</option>
                    <option value="general">General</option>
                </select>
            </div>
            <div>
                <label style="display: block; font-size: 12px; font-weight: 500; color: var(--text-secondary); margin-bottom: 6px;">Filter by Status</label>
                <select class="form-control" id="statusFilter">
                    <option value="">All Status</option>
                    <option value="open">Open</option>
                    <option value="assigned">Assigned</option>
                    <option value="resolved">Resolved</option>
                    <option value="closed">Closed</option>
                </select>
            </div>
            <div>
                <label style="display: block; font-size: 12px; font-weight: 500; color: var(--text-secondary); margin-bottom: 6px;">Search</label>
                <input type="text" class="form-control" placeholder="Search tickets..." />
            </div>
        </div>
    </div>

    <div id="ticketsList">
        <div class="ticket-card">
            <div class="ticket-header">
                <div>
                    <div class="ticket-title">Unable to upload book cover</div>
                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Submitted by: john.doe@example.com</div>
                </div>
                <span class="ticket-type type-bug">Bug</span>
            </div>
            <p style="color: var(--text-secondary); margin: 12px 0;">I'm getting an error when trying to upload a book cover. The file is under 5MB and in JPG format.</p>
            <div class="ticket-meta">
                <span><i class="fas fa-calendar"></i> Jan 15, 2025</span>
                <span><i class="fas fa-user"></i> Unassigned</span>
                <span><i class="fas fa-circle" style="color: var(--success);"></i> Open</span>
            </div>
            <div style="margin-top: 16px; display: flex; gap: 8px;">
                <button class="btn btn-primary" onclick="assignTicket(1)">
                    <i class="fas fa-user-plus"></i> Assign
                </button>
                <button class="btn btn-secondary" onclick="viewTicket(1)">
                    <i class="fas fa-eye"></i> View Details
                </button>
                <button class="btn btn-secondary" onclick="respondTicket(1)">
                    <i class="fas fa-reply"></i> Respond
                </button>
            </div>
        </div>

        <div class="ticket-card">
            <div class="ticket-header">
                <div>
                    <div class="ticket-title">Feature request: Dark mode</div>
                    <div style="font-size: 12px; color: var(--text-secondary); margin-top: 4px;">Submitted by: jane.smith@example.com</div>
                </div>
                <span class="ticket-type type-feature">Feature</span>
            </div>
            <p style="color: var(--text-secondary); margin: 12px 0;">It would be great to have a dark mode option for the platform. Many users work late at night.</p>
            <div class="ticket-meta">
                <span><i class="fas fa-calendar"></i> Jan 14, 2025</span>
                <span><i class="fas fa-user"></i> Assigned to: Admin</span>
                <span><i class="fas fa-circle" style="color: var(--warning);"></i> In Progress</span>
            </div>
            <div style="margin-top: 16px; display: flex; gap: 8px;">
                <button class="btn btn-primary" onclick="viewTicket(2)">
                    <i class="fas fa-eye"></i> View Details
                </button>
                <button class="btn btn-secondary" onclick="respondTicket(2)">
                    <i class="fas fa-reply"></i> Respond
                </button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    function assignTicket(id) {
        Swal.fire({
            title: 'Assign Ticket',
            input: 'select',
            inputOptions: {
                'admin1': 'Admin User 1',
                'admin2': 'Admin User 2',
                'admin3': 'Admin User 3'
            },
            showCancelButton: true,
            confirmButtonText: 'Assign',
            confirmButtonColor: '#8B7355'
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire('Assigned!', 'Ticket has been assigned successfully.', 'success');
            }
        });
    }

    function viewTicket(id) {
        Swal.fire({
            title: 'Ticket Details',
            html: `Ticket ID: ${id}<br>View full ticket details, conversation history, and attachments.`,
            showConfirmButton: true,
            confirmButtonText: 'Close',
            width: '600px'
        });
    }

    function respondTicket(id) {
        Swal.fire({
            title: 'Respond to Ticket',
            input: 'textarea',
            inputPlaceholder: 'Enter your response...',
            showCancelButton: true,
            confirmButtonText: 'Send Response',
            confirmButtonColor: '#8B7355',
            inputValidator: (value) => {
                if (!value) {
                    return 'Please enter a response';
                }
            }
        }).then((result) => {
            if (result.isConfirmed) {
                Swal.fire('Sent!', 'Your response has been sent.', 'success');
            }
        });
    }
</script>

